<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="static/css/index.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <title>Semaforo</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:ital,opsz,wght@0,14..32,100..900;1,14..32,100..900&family=Kanit&display=swap" rel="stylesheet">

</head>
<body class="back">
    <h1 class="title">Clicca il bottone appena le luci del semaforo diventano verdi!</h1>

    <div class="container text-center">
        <div class="row align-items-start">
          <div class="col">
          </div>
          <div class="col">
            <div class="rect">
                <div id="circle1" class="def">
                    
                </div>
                <div id="circle2" class="def">
                    
                </div>
                <div id="circle3" class="def">
                    
                </div>
            </div>
          </div>
          <div class="col">
          </div>
        </div>
    </div>
    
    <div class="container text-center">
        <div class="row align-items-start">
          <div class="col">
          </div>
          <div class="col">
            <input type="button" value="Premi!" id="button">
          </div>
          <div class="col">
          </div>
        </div>
    </div>

    <div class="container text-center">
        <div class="row align-items-start">
          <div class="col">
          </div>
          <div class="col">
            <div id="message"></div>
          </div>
          <div class="col">
          </div>
        </div>
    </div>





    <script>
        function generateRandomInteger(min, max) {
            return Math.floor(Math.random() * (max - min + 1)) + min;
        }


        let c1 = document.querySelector("#circle1")
        let c2 = document.querySelector("#circle2")
        let c3 = document.querySelector("#circle3")
        let button = document.querySelector("#button")
        let message = document.querySelector("#message");
        let now;
        let now2;
        let click = true;
        let randomNumber1 = generateRandomInteger(1, 5);
        let randomNumber2 = generateRandomInteger(1, 5);
        let randomNumber3 = generateRandomInteger(1, 5);
        let randomNumber4 = generateRandomInteger(1, 5);
        let a = randomNumber1*1000
        let br = (randomNumber1+randomNumber2)*1000
        let bra = (randomNumber1+randomNumber2+randomNumber3)*1000
        let bros = bra+(randomNumber4*1000)


        setTimeout(function(){
            c1.classList.remove("def")
            c1.classList.add("def1")
        }, a)

        setTimeout(function(){
            c2.classList.remove("def")
            c2.classList.add("def1")
        }, br)

        setTimeout(function(){
            c3.classList.remove("def")
            c3.classList.add("def1")
        }, bra)

        setTimeout(function(){
            c1.classList.remove("def1")
            c2.classList.remove("def1")
            c3.classList.remove("def1")
            c1.classList.add("def2")
            c2.classList.add("def2")
            c3.classList.add("def2")
            now = new Date()
        }, bros)

        button.addEventListener('click', function () {
            if (click===true){
                if (now>0){
                now2 = new Date()
                let deltaMilliseconds = now2.getTime() - now.getTime()
                let deltaSeconds = deltaMilliseconds/1000
                message.textContent = "Il tempo trascorso dal semaforo verde e' " + deltaSeconds;
                c1.classList.remove("def2")
                c2.classList.remove("def2")
                c3.classList.remove("def2")
                c1.classList.add("def")
                c2.classList.add("def")
                c3.classList.add("def")
            }else{
                message.textContent = "Hai cliccato il bottone prima dell'avvio del semaforo!";
            }}
            click=false;
        })
        


    </script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
</body>
</html>